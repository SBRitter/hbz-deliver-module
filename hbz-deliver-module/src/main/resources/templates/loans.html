<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<title>loans for patron</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script src="http://code.jquery.com/jquery-latest.js"></script>
<link
	th:href="@{http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css}"
	rel="stylesheet" />

</head>
<body>
	<div class="container">
		<div class="jumbotron">
			<h2>loan list</h2>
		</div>
		<div class="page-header">

			<div class="row">

				<div class="col-md-6">
					<div class="input-group">
						<input type="text" class="form-control"
							id="patronId" /> <span
							class="input-group-btn">
							<button class="btn btn-primary" type="button" id="getLoansButton">get
								loans!</button>
						</span>
					</div>
				</div>
				<div class="col-md-6"></div>
				<div class="col-md-12">
					<br />
					<table class="table"></table>
				</div>
			</div>
		</div>
	</div>
	<script th:inline="javascript" type="text/javascript">
		/*<![CDATA[*/
		$(document).ready(function() {
			$('#getLoansButton').click(function() {
				$.get("/deliver/loans/" + $('#patronId').val(), function(data) {
					$('.table').empty();
					var loanArray = $.parseJSON(data);
					var tr;
					tr = $('<tr/>');
					tr.append("<th>loan id</th>");
					tr.append("<th>item id</th>");
					tr.append("<th>title</th>");
					tr.append("<th>actions</th>");
					$('table').append(tr);

					for (var i = 0; i < loanArray.length; i++) {
						tr = $('<tr/>');
						tr.append("<td>" + loanArray[i]._id + "</td>");
						tr.append("<td>" + loanArray[i].item_id + "</td>");
						tr.append("<td>" + loanArray[i].title + "</td>");
						tr.append("<td><button type='button' id='loanButton' class='btn btn-primary'>return</button></td>");
						$('table').append(tr);
					}
				});
			})
		});
		/*]]>*/
	</script>

</body>
</html>